<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AERKO_ // ROADMAP</title>
    <link rel="icon" type="image/svg+xml" href="assets/img/favicon.svg">
    <!-- Fuentes -->
    <link href="https://api.fontshare.com/v2/css?f[]=clash-display@200,300,400,500,600,700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;700&display=swap" rel="stylesheet">
    <!-- CSS -->
    <link rel="stylesheet" href="assets/css/style.css">
</head>

<body class="bg-black-force">

    <!-- Header Dinámico -->
    <header id="app-header" class="header-container"></header>

    <!-- BARRA SUPERIOR (Nuevo Diseño) -->
    <div class="roadmap-bar">
        <div class="rm-bar-left">
            <span class="body-label text-acid" data-i18n="rm_bar_left"></span>
        </div>
        <div class="rm-bar-right">
            <span class="body-label text-acid" data-i18n="rm_bar_right"></span>
        </div>
    </div>

    <!-- CONTENEDOR PRINCIPAL CON ANIMACIÓN -->
    <section class="roadmap-container">
        
        <!-- 1. LA LÍNEA DE FONDO + BARRA VERDE ANIMADA -->
        <div class="roadmap-track-container">
            <div class="roadmap-progress-bar" id="progressBar"></div>
        </div>

        <!-- 2. LAS FILAS (ITEMS) -->
        
        <!-- ITEM 1: FASE 1 -->
        <div class="rm-row">
            <div class="rm-marker-col">
                <div class="rm-bubble active" id="m1">1</div>
            </div>
            <div class="rm-content-cell">
                <h2 class="rm-title-h2 text-black" data-i18n="rm_p1_title"></h2>
                <p class="rm-text-p text-black" data-i18n="rm_p1_desc"></p>
            </div>
        </div>

        <!-- ITEM 2: OBJETIVO 1 -->
        <div class="rm-row">
            <div class="rm-marker-col">
                <div class="rm-dot" id="d1"></div>
            </div>
            <div class="rm-content-cell">
                <h3 class="rm-obj-h3" data-i18n="rm_obj1_title"></h3>
                <p class="rm-text-p text-black" data-i18n="rm_obj1_desc"></p>
            </div>
        </div>

        <!-- ITEM 3: FASE 2 -->
        <div class="rm-row">
            <div class="rm-marker-col">
                <div class="rm-bubble" id="m2">2</div>
            </div>
            <div class="rm-content-cell">
                <h2 class="rm-title-h2 text-black" data-i18n="rm_p2_title"></h2>
                <p class="rm-text-p text-black" data-i18n="rm_p2_desc"></p>
            </div>
        </div>

        <!-- ITEM 4: OBJETIVO 2 -->
        <div class="rm-row">
            <div class="rm-marker-col">
                <div class="rm-dot" id="d2"></div>
            </div>
            <div class="rm-content-cell">
                <h3 class="rm-obj-h3" data-i18n="rm_obj2_title"></h3>
                <p class="rm-text-p text-black" data-i18n="rm_obj2_desc"></p>
            </div>
        </div>

        <!-- ITEM 5: FASE 3 -->
        <div class="rm-row">
            <div class="rm-marker-col">
                <div class="rm-bubble" id="m3">3</div>
            </div>
            <div class="rm-content-cell">
                <h2 class="rm-title-h2 text-black" data-i18n="rm_p3_title"></h2>
                <p class="rm-text-p text-black" data-i18n="rm_p3_desc"></p>
            </div>
        </div>

    </section>

    <!-- Footer Dinámico -->
    <footer id="app-footer" class="main-footer footer-seamless"></footer>

    <!-- SCRIPTS -->
    <script src="assets/js/components.js"></script>
    <script src="assets/js/translations.js"></script>
    <script src="assets/js/i18n.js"></script>
    <script src="assets/js/main.js"></script>

    <!-- SCRIPT DE ANIMACIÓN (Manteniendo lo que funcionaba) -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const progressBar = document.getElementById('progressBar');
            const container = document.querySelector('.roadmap-container');
            const markers = ['m1', 'd1', 'm2', 'd2', 'm3']; 

            function updateRoadmap() {
                if (!container) return;

                // Cálculos de posición
                const rect = container.getBoundingClientRect();
                const windowHeight = window.innerHeight;
                
                // La barra se empieza a llenar cuando el container entra por la mitad de la pantalla
                const triggerPoint = windowHeight * 0.6; 
                
                let progress = -rect.top + triggerPoint;
                const totalHeight = container.offsetHeight;
                
                let heightPercentage = (progress / totalHeight) * 100;
                heightPercentage = Math.max(0, Math.min(100, heightPercentage));

                // Pintar la barra
                progressBar.style.height = heightPercentage + '%';

                // Activar bolas al pasar
                const currentBarPx = (heightPercentage / 100) * totalHeight;

                markers.forEach(id => {
                    const el = document.getElementById(id);
                    if(!el) return;
                    const row = el.closest('.rm-row');
                    // Ajuste: Calculamos cuando la barra llega a la bola
                    const markerPosition = row.offsetTop + 50; 

                    if (currentBarPx > markerPosition) {
                        el.classList.add('active');
                    } else {
                        // Opcional: si quieres que se apaguen al subir, deja esto.
                        // Si quieres que se queden encendidas, quita el else.
                        // el.classList.remove('active'); 
                        if (id !== 'm1') el.classList.remove('active'); // M1 siempre activo
                    }
                });
            }

            window.addEventListener('scroll', updateRoadmap);
            window.addEventListener('resize', updateRoadmap);
            updateRoadmap();
        });
    </script>

</body>
</html>
